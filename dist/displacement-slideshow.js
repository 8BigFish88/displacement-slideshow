var e=require("three"),t=require("gsap");function n(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if("default"!==n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,t}var i=/*#__PURE__*/n(e);module.exports=function(e){function n(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]}console.log("%c Hover effect by Robin Delaporte: https://github.com/robin-dela/hover-effect ","color: #bada55; font-size: 0.8rem");var r=e.parent,o=e.displacementImage,a=e.image1,s=e.image2,f=n(e.images,[e.image1,e.image2]),l=n(e.imagesRatio,1),u=n(e.intensity1,e.intensity,1),d=n(e.intensity2,e.intensity,1),c=n(e.angle,Math.PI/4),v=n(e.angle1,c),g=n(e.angle2,3*-c),p=n(e.easing,"power1.inOut"),m=n(e.speedIn,e.speed,1.6),h=n(e.speedOut,e.speed,1.2),y=n(e.transitionDelay,3e3),x=0,F=1,w=void 0,H=void 0,W=void 0,P=null,b=null,O=[],D=null,M=null,S=null;if(r)if((f||a&&s)&&o){var U,V,_=new i.Scene,C=new i.OrthographicCamera(r.offsetWidth/-2,r.offsetWidth/2,r.offsetHeight/2,r.offsetHeight/-2,1,1e3),L=new i.WebGLRenderer({antialias:!1,alpha:!0}),R=l,z=function(){L.render(_,C)};C.position.z=1,L.setPixelRatio(2),L.setClearColor(16777215,0),L.setSize(r.offsetWidth,r.offsetHeight),r.appendChild(L.domElement),r.offsetHeight/r.offsetWidth<R?(U=1,V=r.offsetHeight/r.offsetWidth/R):(U=r.offsetWidth/r.offsetHeight*R,V=1),(M=new i.TextureLoader).crossOrigin="",(D=M.load(o,z)).magFilter=D.minFilter=i.LinearFilter,P=b||M.load(f[x],z),b=M.load(f[F],z),P.magFilter=b.magFilter=i.LinearFilter,P.minFilter=b.minFilter=i.LinearFilter,w=new i.ShaderMaterial({uniforms:{intensity1:{type:"f",value:u},intensity2:{type:"f",value:d},dispFactor:{type:"f",value:0},angle1:{type:"f",value:v},angle2:{type:"f",value:g},texture1:{type:"t",value:P},texture2:{type:"t",value:b},disp:{type:"t",value:D},res:{type:"vec4",value:new i.Vector4(r.offsetWidth,r.offsetHeight,U,V)},dpr:{type:"f",value:window.devicePixelRatio}},vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",fragmentShader:"\nvarying vec2 vUv;\n\nuniform float dispFactor;\nuniform float dpr;\nuniform sampler2D disp;\n\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform float angle1;\nuniform float angle2;\nuniform float intensity1;\nuniform float intensity2;\nuniform vec4 res;\nuniform vec2 parent;\n\nmat2 getRotM(float angle) {\n  float s = sin(angle);\n  float c = cos(angle);\n  return mat2(c, -s, s, c);\n}\n\nvoid main() {\n  vec4 disp = texture2D(disp, vUv);\n  vec2 dispVec = vec2(disp.r, disp.g);\n\n  vec2 uv = 0.5 * gl_FragCoord.xy / (res.xy) ;\n  vec2 myUV = (uv - vec2(0.5))*res.zw + vec2(0.5);\n\n\n  vec2 distortedPosition1 = myUV + getRotM(angle1) * dispVec * intensity1 * dispFactor;\n  vec2 distortedPosition2 = myUV + getRotM(angle2) * dispVec * intensity2 * (1.0 - dispFactor);\n  vec4 _texture1 = texture2D(texture1, distortedPosition1);\n  vec4 _texture2 = texture2D(texture2, distortedPosition2);\n  gl_FragColor = mix(_texture1, _texture2, dispFactor);\n}\n",transparent:!0,opacity:1}),_=new i.Scene,W=new i.PlaneBufferGeometry(r.offsetWidth,r.offsetHeight,1),H=new i.Mesh(W,w),_.add(H),window.addEventListener("resize",function(e){r.offsetHeight/r.offsetWidth<R?(U=1,V=r.offsetHeight/r.offsetWidth/R):(U=r.offsetWidth/r.offsetHeight*R,V=1),H.material.uniforms.res.value=new i.Vector4(r.offsetWidth,r.offsetHeight,U,V),L.setSize(r.offsetWidth,r.offsetHeight),z()}),this.next=I,this.playSlideshow=function(){O=f.map(function(e,t){var n=t==f.length-1?0:t+1;return P=b||M.load(e,z),b=M.load(f[n],z),P.magFilter=b.magFilter=i.LinearFilter,P.minFilter=b.minFilter=i.LinearFilter,{currentIndex:t,texture1:P,texture2:b}});var e=0;return j(e),S=setInterval(function(){I(),j(e=F),b=O[e].texture2,w.uniforms.texture1.value=P=O[e].texture1,w.uniforms.texture2.value=b,w.uniforms.dispFactor.value=0},y)},this.stopSlideshow=function(){S&&clearInterval(S)},this.previous=function(){t.gsap.to(w.uniforms.dispFactor,{duration:h,value:0,ease:p,onUpdate:z,onComplete:z})}}else console.warn("One or more images are missing");else console.warn("Parent missing");function I(){t.gsap.to(w.uniforms.dispFactor,{duration:m,value:1,ease:p,onUpdate:z,onComplete:z})}function j(e){x=e,F=e==f.length-1?0:e+1}};
//# sourceMappingURL=displacement-slideshow.js.map
