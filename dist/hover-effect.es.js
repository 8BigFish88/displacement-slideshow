import{Scene as e,OrthographicCamera as t,WebGLRenderer as n,TextureLoader as i,LinearFilter as o,ShaderMaterial as s,Vector4 as a,PlaneBufferGeometry as r,Mesh as f}from"three";import l from"gsap/TweenMax";export default function(d){function u(){for(var e=arguments,t=0;t<arguments.length;t++)if(void 0!==e[t])return e[t]}console.log("%c Hover effect by Robin Delaporte: https://github.com/robin-dela/hover-effect ","color: #bada55; font-size: 0.8rem");var v=d.parent,p=d.displacementImage,m=d.image1,c=d.image2,g=u(d.images,[d.image1,d.image2]),h=u(d.imagesRatio,1),y=u(d.intensity1,d.intensity,1),x=u(d.intensity2,d.intensity,1),w=u(d.angle,Math.PI/4),F=u(d.angle1,w),H=u(d.angle2,3*-w),W=u(d.speedIn,d.speed,1.6),P=u(d.speedOut,d.speed,1.2),U=u(d.easing,Expo.easeOut),D=u(d.transitionDelay,3e3),C=0,M=1,R=void 0,V=void 0,_=void 0,z=null,S=null,b=null,I=null,O=null;if(v)if((g||m&&c)&&p){var E,j,L=new e,T=new t(v.offsetWidth/-2,v.offsetWidth/2,v.offsetHeight/2,v.offsetHeight/-2,1,1e3),k=new n({antialias:!1,alpha:!0}),q=h,A=function(){k.render(L,T)};T.position.z=1,k.setPixelRatio(2),k.setClearColor(16777215,0),k.setSize(v.offsetWidth,v.offsetHeight),v.appendChild(k.domElement),v.offsetHeight/v.offsetWidth<q?(E=1,j=v.offsetHeight/v.offsetWidth/q):(E=v.offsetWidth/v.offsetHeight*q,j=1),(I=new i).crossOrigin="",(b=I.load(p,A)).magFilter=b.minFilter=o,J(),R=new s({uniforms:{intensity1:{type:"f",value:y},intensity2:{type:"f",value:x},dispFactor:{type:"f",value:0},angle1:{type:"f",value:F},angle2:{type:"f",value:H},texture1:{type:"t",value:z},texture2:{type:"t",value:S},disp:{type:"t",value:b},res:{type:"vec4",value:new a(v.offsetWidth,v.offsetHeight,E,j)},dpr:{type:"f",value:window.devicePixelRatio}},vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",fragmentShader:"\nvarying vec2 vUv;\n\nuniform float dispFactor;\nuniform float dpr;\nuniform sampler2D disp;\n\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform float angle1;\nuniform float angle2;\nuniform float intensity1;\nuniform float intensity2;\nuniform vec4 res;\nuniform vec2 parent;\n\nmat2 getRotM(float angle) {\n  float s = sin(angle);\n  float c = cos(angle);\n  return mat2(c, -s, s, c);\n}\n\nvoid main() {\n  vec4 disp = texture2D(disp, vUv);\n  vec2 dispVec = vec2(disp.r, disp.g);\n\n  vec2 uv = 0.5 * gl_FragCoord.xy / (res.xy) ;\n  vec2 myUV = (uv - vec2(0.5))*res.zw + vec2(0.5);\n\n\n  vec2 distortedPosition1 = myUV + getRotM(angle1) * dispVec * intensity1 * dispFactor;\n  vec2 distortedPosition2 = myUV + getRotM(angle2) * dispVec * intensity2 * (1.0 - dispFactor);\n  vec4 _texture1 = texture2D(texture1, distortedPosition1);\n  vec4 _texture2 = texture2D(texture2, distortedPosition2);\n  gl_FragColor = mix(_texture1, _texture2, dispFactor);\n}\n",transparent:!0,opacity:1}),L=new e,_=new r(v.offsetWidth,v.offsetHeight,1),V=new f(_,R),L.add(V),window.addEventListener("resize",function(e){v.offsetHeight/v.offsetWidth<q?(E=1,j=v.offsetHeight/v.offsetWidth/q):(E=v.offsetWidth/v.offsetHeight*q,j=1),V.material.uniforms.res.value=new a(v.offsetWidth,v.offsetHeight,E,j),k.setSize(v.offsetWidth,v.offsetHeight),A()}),this.next=B,this.playSlideshow=function(){var e=0;return G(e),O=setInterval(function(){B(),G(e=M),J(),R.uniforms.texture1.value=z,R.uniforms.texture2.value=S,R.uniforms.dispFactor.value=0},D)},this.stopSlideshow=function(){O&&clearInterval(O)},this.previous=function(){l.to(R.uniforms.dispFactor,P,{value:0,ease:U,onUpdate:A,onComplete:A})}}else console.warn("One or more images are missing");else console.warn("Parent missing");function B(){l.to(R.uniforms.dispFactor,W,{value:1,ease:U,onUpdate:A,onComplete:A})}function G(e){C=e,M=e==g.length-1?0:e+1}function J(){z=S||I.load(g[C],A),S=I.load(g[M],A),z.magFilter=S.magFilter=o,z.minFilter=S.minFilter=o}}
//# sourceMappingURL=hover-effect.es.js.map
